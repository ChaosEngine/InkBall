"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var StatusEnum=Object.freeze({POINT_FREE:-1,POINT_STARTING:0,POINT_IN_PATH:1,POINT_OWNED_BY_RED:2,POINT_OWNED_BY_BLU:3}),CommandKindEnum=Object.freeze({UNKNOWN:-1,PING:0,POINT:1,PATH:2,PLAYER_JOINING:3,PLAYER_SURRENDE:4}),InkBallPointViewModel=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,f=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:StatusEnum.POINT_FREE,h=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0;_classCallCheck(this,a),this.iId=b,this.iGameId=c,this.iPlayerId=d,this.iX=e,this.iY=f,this.Status=g,this.iEnclosingPathId=h}return _createClass(a,null,[{key:"Format",value:function d(a,b){var c=b.iX+" "+b.iY+" "+b.Status;return a+" places "+c+" point"}}]),a}(),PingCommand=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";_classCallCheck(this,a),this.Message=b}return _createClass(a,[{key:"Message",get:function a(){return this.message},set:function b(a){this.message=a}}]),_createClass(a,null,[{key:"Format",value:function d(a,b){var c=b.Message;return a+" says "+c}}]),a}();function htmlEncode(a){return document.createElement("a").appendChild(document.createTextNode(a)).parentNode.innerHTML}var g_SignalRConnection=null,g_iGameID=null,g_iPlayerID=null;function BuildSignalR(a,b,c,d,e){null===a||""===a||(g_SignalRConnection=new signalR.HubConnectionBuilder().withUrl(a,{transport:d,accessTokenFactory:e}).withHubProtocol(c).configureLogging(b).build())}function StartSignalRConnection(a,b){function c(){return d.apply(this,arguments)}function d(){return d=_asyncToGenerator(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g_SignalRConnection.start();case 3:e=0,console.log("connected; iConnErrCount = "+e),a.next=12;break;case 7:a.prev=7,a.t0=a["catch"](0),console.log(a.t0+"; iConnErrCount = "+e),5>e&&e++,setTimeout(function(){return c()},4e3+2e3*e);case 12:case"end":return a.stop();}},a,this,[[0,7]])})),d.apply(this,arguments)}var e=0;null===g_SignalRConnection||(g_iGameID=a,g_iPlayerID=b,g_SignalRConnection.on("ServerToClientPoint",function(a,b){var c=null;c=InkBallPointViewModel.Format(b,a);var d=document.createElement("li");d.textContent=c,document.getElementById("messagesList").appendChild(d)}),g_SignalRConnection.on("ServerToClientPing",function(a,b){var c=null;c=PingCommand.Format(b,a);var d=document.createElement("li");d.textContent=c,document.getElementById("messagesList").appendChild(d)}),document.getElementById("sendButton").addEventListener("click",function(a){var b=document.getElementById("messageInput").value,c=new PingCommand(b);g_SignalRConnection.invoke("ClientToServerPing",c).catch(function(a){return console.error(a.toString())}),a.preventDefault()}),document.getElementById("messageInput").addEventListener("keyup",function(a){a.preventDefault(),13===a.keyCode&&document.getElementById("sendButton").click()}),g_SignalRConnection.onclose(function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(null===b){a.next=6;break}console.log(b),5>e&&e++,setTimeout(function(){return c()},4e3+2e3*e),a.next=8;break;case 6:return a.next=8,c();case 8:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()),c())}