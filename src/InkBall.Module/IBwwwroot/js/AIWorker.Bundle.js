!function(){var t={273:function(t,e,n){"use strict";var i=n(582),r=n(842),o=n(960),s=n(639).orient2d;function a(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>i[0]&&(i=a),a[1]<n[1]&&(n=a),a[1]>r[1]&&(r=a)}var h=[e,n,i,r],l=h.slice();for(s=0;s<t.length;s++)o(t[s],h)||l.push(t[s]);return function(t){t.sort(x);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&f(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var i=[],r=t.length-1;r>=0;r--){for(;i.length>=2&&f(i[i.length-2],i[i.length-1],t[r])<=0;)i.pop();i.push(t[r])}return i.pop(),e.pop(),e.concat(i)}(l)}(t),s=new i(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,l=[],u=0;u<r.length;u++){var c=r[u];s.remove(c),a=m(c,a),l.push(a)}var p=new i(16);for(u=0;u<l.length;u++)p.insert(d(l[u]));for(var v=e*e,g=n*n;l.length;){var b=l.shift(),_=b.p,S=b.next.p,P=y(_,S);if(!(P<g)){var E=P/v;(c=h(s,b.prev.p,_,S,b.next.next.p,E,p))&&Math.min(y(c,_),y(c,S))<=E&&(l.push(b),l.push(m(c,b)),s.remove(c),p.remove(b),p.insert(d(b)),p.insert(d(b.next)))}}b=a;var G=[];do{G.push(b.p),b=b.next}while(b!==a);return G.push(b.p),G}function h(t,e,n,i,o,s,a){for(var h=new r([],l),c=t.data;c;){for(var f=0;f<c.children.length;f++){var d=c.children[f],m=c.leaf?v(d,n,i):u(n,i,d);m>s||h.push({node:d,dist:m})}for(;h.length&&!h.peek().node.children;){var y=h.pop(),g=y.node,x=v(g,e,n),b=v(g,i,o);if(y.dist<x&&y.dist<b&&p(n,g,a)&&p(i,g,a))return g}(c=h.pop())&&(c=c.node)}return null}function l(t,e){return t.dist-e.dist}function u(t,e,n){if(c(t,n)||c(e,n))return 0;var i=g(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=g(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=g(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=g(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(i,r,o,s)}function c(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function p(t,e,n){for(var i,r,o,s,a=Math.min(t[0],e[0]),h=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),u=Math.max(t[1],e[1]),c=n.search({minX:a,minY:h,maxX:l,maxY:u}),p=0;p<c.length;p++)if(i=c[p].p,r=c[p].next.p,o=t,i!==(s=e)&&r!==o&&f(i,r,o)>0!=f(i,r,s)>0&&f(o,s,i)>0!=f(o,s,r)>0)return!1;return!0}function f(t,e,n){return s(t[0],t[1],e[0],e[1],n[0],n[1])}function d(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function m(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function y(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function v(t,e,n){var i=e[0],r=e[1],o=n[0]-i,s=n[1]-r;if(0!==o||0!==s){var a=((t[0]-i)*o+(t[1]-r)*s)/(o*o+s*s);a>1?(i=n[0],r=n[1]):a>0&&(i+=o*a,r+=s*a)}return(o=t[0]-i)*o+(s=t[1]-r)*s}function g(t,e,n,i,r,o,s,a){var h,l,u,c,p=n-t,f=i-e,d=s-r,m=a-o,y=t-r,v=e-o,g=p*p+f*f,x=p*d+f*m,b=d*d+m*m,_=p*y+f*v,S=d*y+m*v,P=g*b-x*x,E=P,G=P;0===P?(l=0,E=1,c=S,G=b):(c=g*S-x*_,(l=x*S-b*_)<0?(l=0,c=S,G=b):l>E&&(l=E,c=S+x,G=b)),c<0?(c=0,-_<0?l=0:-_>g?l=E:(l=-_,E=g)):c>G&&(c=G,-_+x<0?l=0:-_+x>g?l=E:(l=-_+x,E=g));var A=(1-(u=0===c?0:c/G))*r+u*s-((1-(h=0===l?0:l/E))*t+h*n),M=(1-u)*o+u*a-((1-h)*e+h*i);return A*A+M*M}function x(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}r.default&&(r=r.default),t.exports=a,t.exports.default=a},169:function(t,e){var n,i,r,o;o=function(){function t(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var e={search:function(n,i,o,s){n.cleanDirty();var a=(s=s||{}).heuristic||e.heuristics.manhattan,h=s.closest||!1,l=new r((function(t){return t.f})),u=i;for(i.h=a(i,o),l.push(i);l.size()>0;){var c=l.pop();if(c===o)return t(c);c.closed=!0;for(var p=n.neighbors(c),f=0,d=p.length;f<d;++f){var m=p[f];if(!m.closed&&!m.isWall()){var y=c.g+m.getCost(c),v=m.visited;(!v||y<m.g)&&(m.visited=!0,m.parent=c,m.h=m.h||a(m,o),m.g=y,m.f=m.g+m.h,n.markDirty(m),h&&(m.h<u.h||m.h===u.h&&m.g<u.g)&&(u=m),v?l.rescoreElement(m):l.push(m))}}}return h?t(u):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function n(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var r=0,o=t[n];r<o.length;r++){var s=new i(n,r,o[r]);this.grid[n][r]=s,this.nodes.push(s)}}this.init()}function i(t,e,n){this.x=t,this.y=e,this.weight=n}function r(t){this.content=[],this.scoreFunction=t}return n.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)e.cleanNode(this.nodes[t])},n.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)e.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},n.prototype.markDirty=function(t){this.dirtyNodes.push(t)},n.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},n.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,i=(e=o[s]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},i.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},i.prototype.getCost=function(t){return t&&t.x!=this.x&&t.y!=this.y?1.41421*this.weight:this.weight},i.prototype.isWall=function(){return 0===this.weight},r.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var h=this.content[s];(r=this.scoreFunction(h))<i&&(a=s)}if(o<e){var l=this.content[o];this.scoreFunction(l)<(null===a?i:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}},{astar:e,Graph:n}},"object"==typeof t.exports?t.exports=o():(i=[],void 0===(r="function"==typeof(n=o)?n.apply(void 0,i):n)||(t.exports=r))},895:function(t){t.exports=function(t,e,n,i){var r=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);for(var a=(i-n)/2,h=0,l=a-1;h<a;l=h++){var u=e[n+2*h+0],c=e[n+2*h+1],p=e[n+2*l+0],f=e[n+2*l+1];c>o!=f>o&&r<(p-u)*(o-c)/(f-c)+u&&(s=!s)}return s}},960:function(t,e,n){var i=n(895),r=n(139);t.exports=function(t,e,n,o){return e.length>0&&Array.isArray(e[0])?r(t,e,n,o):i(t,e,n,o)},t.exports.nested=r,t.exports.flat=i},139:function(t){t.exports=function(t,e,n,i){var r=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);for(var a=i-n,h=0,l=a-1;h<a;l=h++){var u=e[h+n][0],c=e[h+n][1],p=e[l+n][0],f=e[l+n][1];c>o!=f>o&&r<(p-u)*(o-c)/(f-c)+u&&(s=!s)}return s}},582:function(t){t.exports=function(){"use strict";function t(t,i,r,o,s){!function t(n,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,h=i-r+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(h-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-h*u/a+c)),Math.min(o,Math.floor(i+(a-h)*u/a+c)),s)}var p=n[i],f=r,d=o;for(e(n,r,i),s(n[o],p)>0&&e(n,r,o);f<d;){for(e(n,f,d),f++,d--;s(n[f],p)<0;)f++;for(;s(n[d],p)>0;)d--}0===s(n[r],p)?e(n,r,d):e(n,++d,o),d<=i&&(r=d+1),i<=d&&(o=d-1)}}(t,i,r||0,o||t.length-1,s||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(r,t.leaf?i(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,n,i,r,o){for(var s=[n,i];s.length;)if(!((i=s.pop())-(n=s.pop())<=r)){var a=n+Math.ceil((i-n)/r/2)*r;t(e,a,n,i,o),s.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!f(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?i(s):s;f(t,a)&&(e.leaf?n.push(s):p(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],o=e.leaf?this.toBBox(r):r;if(f(t,o)){if(e.leaf||p(t,o))return!0;n.push(r)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=d([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,o,s=this.data,a=this.toBBox(t),h=[],l=[];s||h.length;){if(s||(s=h.pop(),i=h[h.length-1],n=l.pop(),o=!0),s.leaf){var u=r(t,s.children,e);if(-1!==u)return s.children.splice(u,1),h.push(s),this._condense(h),this}o||s.leaf||!p(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(h.push(s),l.push(n),n=0,i=s,s=s.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=d(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=d([])).leaf=!1,r.height=i;var h=Math.ceil(s/a),l=h*Math.ceil(Math.sqrt(a));m(t,e,n,l,this.compareMinX);for(var u=e;u<=n;u+=l){var c=Math.min(u+l-1,n);m(t,u,c,h,this.compareMinY);for(var p=u;p<=c;p+=h){var f=Math.min(p+h-1,c);r.children.push(this._build(t,p,f,i-1))}}return o(r,this.toBBox),r},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=u(h),c=(p=t,f=h,(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l);c<o?(o=c,r=l<r?l:r,s=h):c===o&&l<r&&(r=l,s=h)}e=s||e.children[0]}var p,f;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],o=this._chooseSubtree(i,this.data,e,r);for(o.children.push(t),a(o,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=d(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,r,o,a,h,l,c,p=1/0,f=1/0,d=e;d<=n-e;d++){var m=s(t,0,d,this.toBBox),y=s(t,d,n,this.toBBox),v=(r=m,o=y,a=void 0,h=void 0,l=void 0,c=void 0,a=Math.max(r.minX,o.minX),h=Math.max(r.minY,o.minY),l=Math.min(r.maxX,o.maxX),c=Math.min(r.maxY,o.maxY),Math.max(0,l-a)*Math.max(0,c-h)),g=u(m)+u(y);v<p?(p=v,i=d,f=g<f?g:f):v===p&&g<f&&(f=g,i=d)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,o=s(t,0,e,r),h=s(t,n-e,n,r),l=c(o)+c(h),u=e;u<n-e;u++){var p=t.children[u];a(o,t.leaf?r(p):p),l+=c(o)}for(var f=n-e-1;f>=e;f--){var d=t.children[f];a(h,t.leaf?r(d):d),l+=c(h)}return l},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},i}()},639:function(t,e){!function(t){"use strict";const e=134217729,n=33306690738754706e-32;function i(t,e,n,i,r){let o,s,a,h,l=e[0],u=i[0],c=0,p=0;u>l==u>-l?(o=l,l=e[++c]):(o=u,u=i[++p]);let f=0;if(c<t&&p<n)for(u>l==u>-l?(a=o-((s=l+o)-l),l=e[++c]):(a=o-((s=u+o)-u),u=i[++p]),o=s,0!==a&&(r[f++]=a);c<t&&p<n;)u>l==u>-l?(a=o-((s=o+l)-(h=s-o))+(l-h),l=e[++c]):(a=o-((s=o+u)-(h=s-o))+(u-h),u=i[++p]),o=s,0!==a&&(r[f++]=a);for(;c<t;)a=o-((s=o+l)-(h=s-o))+(l-h),l=e[++c],o=s,0!==a&&(r[f++]=a);for(;p<n;)a=o-((s=o+u)-(h=s-o))+(u-h),u=i[++p],o=s,0!==a&&(r[f++]=a);return 0===o&&0!==f||(r[f++]=o),f}function r(t){return new Float64Array(t)}const o=33306690738754716e-32,s=22204460492503146e-32,a=11093356479670487e-47,h=r(4),l=r(8),u=r(12),c=r(16),p=r(4);t.orient2d=function(t,r,f,d,m,y){const v=(r-y)*(f-m),g=(t-m)*(d-y),x=v-g;if(0===v||0===g||v>0!=g>0)return x;const b=Math.abs(v+g);return Math.abs(x)>=o*b?x:-function(t,r,o,f,d,m,y){let v,g,x,b,_,S,P,E,G,A,M,w,O,I,N,C,T,Y;const B=t-d,X=o-d,V=r-m,k=f-m;_=(N=(E=B-(P=(S=e*B)-(S-B)))*(A=k-(G=(S=e*k)-(S-k)))-((I=B*k)-P*G-E*G-P*A))-(M=N-(T=(E=V-(P=(S=e*V)-(S-V)))*(A=X-(G=(S=e*X)-(S-X)))-((C=V*X)-P*G-E*G-P*A))),h[0]=N-(M+_)+(_-T),_=(O=I-((w=I+M)-(_=w-I))+(M-_))-(M=O-C),h[1]=O-(M+_)+(_-C),_=(Y=w+M)-w,h[2]=w-(Y-_)+(M-_),h[3]=Y;let R=function(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}(4,h),D=s*y;if(R>=D||-R>=D)return R;if(v=t-(B+(_=t-B))+(_-d),x=o-(X+(_=o-X))+(_-d),g=r-(V+(_=r-V))+(_-m),b=f-(k+(_=f-k))+(_-m),0===v&&0===g&&0===x&&0===b)return R;if(D=a*y+n*Math.abs(R),(R+=B*b+k*v-(V*x+X*g))>=D||-R>=D)return R;_=(N=(E=v-(P=(S=e*v)-(S-v)))*(A=k-(G=(S=e*k)-(S-k)))-((I=v*k)-P*G-E*G-P*A))-(M=N-(T=(E=g-(P=(S=e*g)-(S-g)))*(A=X-(G=(S=e*X)-(S-X)))-((C=g*X)-P*G-E*G-P*A))),p[0]=N-(M+_)+(_-T),_=(O=I-((w=I+M)-(_=w-I))+(M-_))-(M=O-C),p[1]=O-(M+_)+(_-C),_=(Y=w+M)-w,p[2]=w-(Y-_)+(M-_),p[3]=Y;const F=i(4,h,4,p,l);_=(N=(E=B-(P=(S=e*B)-(S-B)))*(A=b-(G=(S=e*b)-(S-b)))-((I=B*b)-P*G-E*G-P*A))-(M=N-(T=(E=V-(P=(S=e*V)-(S-V)))*(A=x-(G=(S=e*x)-(S-x)))-((C=V*x)-P*G-E*G-P*A))),p[0]=N-(M+_)+(_-T),_=(O=I-((w=I+M)-(_=w-I))+(M-_))-(M=O-C),p[1]=O-(M+_)+(_-C),_=(Y=w+M)-w,p[2]=w-(Y-_)+(M-_),p[3]=Y;const j=i(F,l,4,p,u);_=(N=(E=v-(P=(S=e*v)-(S-v)))*(A=b-(G=(S=e*b)-(S-b)))-((I=v*b)-P*G-E*G-P*A))-(M=N-(T=(E=g-(P=(S=e*g)-(S-g)))*(A=x-(G=(S=e*x)-(S-x)))-((C=g*x)-P*G-E*G-P*A))),p[0]=N-(M+_)+(_-T),_=(O=I-((w=I+M)-(_=w-I))+(M-_))-(M=O-C),p[1]=O-(M+_)+(_-C),_=(Y=w+M)-w,p[2]=w-(Y-_)+(M-_),p[3]=Y;const $=i(j,u,4,p,c);return c[$-1]}(t,r,f,d,m,y,b)},t.orient2dfast=function(t,e,n,i,r,o){return(e-o)*(n-r)-(t-r)*(i-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},842:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return i}});class i{constructor(t=[],e=r){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),o=e[i];const s=i+1;if(s<this.length&&n(e[s],o)<0&&(i=s,o=e[s]),n(o,r)>=0)break;e[t]=o,t=i}e[t]=r}}function r(t,e){return t<e?-1:t>e?1:0}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){"use strict";var t=n(273),e=n.n(t);const i=Object.freeze({POINT_FREE_RED:-3,POINT_FREE_BLUE:-2,POINT_FREE:-1,POINT_STARTING:0,POINT_IN_PATH:1,POINT_OWNED_BY_RED:2,POINT_OWNED_BY_BLUE:3});function r(t){console.log(t)}function o(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];i&&(e+=i)}console.error(e)}"undefined"!=typeof myAlert&&myAlert;function s(t,e,n){const i=t.length;let r,o,s=!1;for(r=0,o=i-1;r<i;o=r++){const i=t[r],a=t[o];(i.y<=n&&n<a.y||a.y<=n&&n<i.y)&&e<(a.x-i.x)*(n-i.y)/(a.y-i.y)+i.x&&(s=!s)}return s}function a(t){const e=t.reduce(((t,e)=>(t.x+=e.x,t.y+=e.y,t)),{x:0,y:0});e.x/=t.length,e.y/=t.length;return t.map((t=>(t.angle=Math.atan2(t.y-e.y,t.x-e.x),t))).sort(((t,e)=>t.angle-e.angle))}class h{#t;#e;constructor(){const t="http://www.w3.org/2000/svg";let e,n,r,o=!1;if(this.#e=null,this.#t=null,self&&self.document&&self.document.createElementNS){const e=document.createElementNS(t,"svg");o=null!==e.x}o?(n=t=>t,r=function(e){switch(e){case"circle":case"line":case"polyline":return document.createElementNS(t,e);default:throw new Error(`unknown type ${e}`)}}):(n=function(){return{attributes:new Map,children:[],setAttributeNS:function(t,e,n){this.attributes.set(e,n)},appendChild:function(t){this.children.push(t)},removeChild:function(t){const e=this.children.indexOf(t);-1!==e&&this.children.splice(e,1)}}},self.SVGCircleElement=function(){this.attributes=new Map},SVGCircleElement.prototype.setAttribute=function(t,e){this.attributes.set(t,e)},SVGCircleElement.prototype.getAttribute=function(t){return this.attributes.get(t)},SVGCircleElement.prototype.removeAttribute=function(t){this.attributes.delete(t)},self.SVGPolylineElement=function(){this.attributes=new Map},SVGPolylineElement.prototype.setAttribute=function(t,e){this.attributes.set(t,e)},SVGPolylineElement.prototype.getAttribute=function(t){return this.attributes.get(t)},SVGPolylineElement.prototype.removeAttribute=function(t){this.attributes.delete(t)},r=function(t){switch(t){case"circle":return new SVGCircleElement;case"polyline":return new SVGPolylineElement;default:throw new Error(`unknown type ${t}`)}}),SVGCircleElement.prototype.move=function(t,e){this.setAttribute("cx",t),this.setAttribute("cy",e)},SVGCircleElement.prototype.GetStrokeColor=function(){return this.getAttribute("stroke")},SVGCircleElement.prototype.SetStrokeColor=function(t){this.setAttribute("stroke",t)},SVGCircleElement.prototype.GetPosition=function(){return void 0===this.cachedPosition&&(this.cachedPosition={x:parseInt(this.getAttribute("cx")),y:parseInt(this.getAttribute("cy"))}),this.cachedPosition},SVGCircleElement.prototype.GetFillColor=function(){return void 0===this.cachedFillColor&&(this.cachedFillColor=this.getAttribute("fill")),this.cachedFillColor},SVGCircleElement.prototype.SetFillColor=function(t){this.cachedFillColor=t,this.setAttribute("fill",t)},SVGCircleElement.prototype.GetStatus=function(){return void 0===this.cachedStatus&&(this.cachedStatus=a(this.getAttribute("data-status"))),this.cachedStatus},SVGCircleElement.prototype.SetStatus=function(t,e=!1){if(e){const e=a(this.getAttribute("data-status"));this.cachedStatus=t,this.setAttribute("data-status",s(this.cachedStatus)),e!==i.POINT_FREE&&e!==t&&this.setAttribute("data-old-status",s(e))}else this.cachedStatus=t,this.setAttribute("data-status",s(t))},SVGCircleElement.prototype.RevertOldStatus=function(){const t=this.getAttribute("data-old-status");return t?(this.removeAttribute("data-old-status"),this.setAttribute("data-status",t),this.cachedStatus=a(t),this.cachedStatus):-1},SVGCircleElement.prototype.GetZIndex=function(){return this.getAttribute("z-index")},SVGCircleElement.prototype.SetZIndex=function(t){this.setAttribute("z-index",t)},SVGCircleElement.prototype.Hide=function(){this.setAttribute("visibility","hidden")},SVGCircleElement.prototype.Show=function(){this.setAttribute("visibility","visible")},SVGCircleElement.prototype.StrokeWeight=function(t){this.setAttribute("stroke-width",t)},SVGCircleElement.prototype.Serialize=function(){const{x:t,y:e}=this.GetPosition();return{x:t,y:e,Status:this.GetStatus(),Color:this.GetFillColor()}},SVGPolylineElement.prototype.AppendPoints=function(t,e,n=1){const i=this.getAttribute("points"),r=i.split(" ");if(r.length<=1||!0==(o=r,new Set(o).size!==o.length))return!1;var o;const s=r.at(-1).split(",");if(2!==s.length)return!1;const a=parseInt(s[0]),h=parseInt(s[1]);return t=parseInt(t),e=parseInt(e),Math.abs(a-t)<=n&&Math.abs(h-e)<=n&&(this.setAttribute("points",i+` ${t},${e}`),!0)},SVGPolylineElement.prototype.RemoveLastPoint=function(){const t=this.getAttribute("points").replace(/(\s\d+,\d+)$/,"");return this.setAttribute("points",t),t},SVGPolylineElement.prototype.ContainsPoint=function(t,e){const n=this.getAttribute("points"),i=`${t},${e}`;let r=0,o=-i.length;for(;(o=n.indexOf(i,o+i.length))>-1;)r++;return r},SVGPolylineElement.prototype.GetPointsString=function(){return this.getAttribute("points")},SVGPolylineElement.prototype.GetPointsArray=function(){return void 0===this.cachedPoints&&(this.cachedPoints=this.getAttribute("points").split(" ").map((function(t){const[e,n]=t.split(",");return{x:parseInt(e),y:parseInt(n)}}))),this.cachedPoints},SVGPolylineElement.prototype.SetPoints=function(t){this.setAttribute("points",t)},SVGPolylineElement.prototype.GetIsClosed=function(){const t=this.getAttribute("points").split(" ");return t[0]===t.at(-1)},SVGPolylineElement.prototype.GetLength=function(){return this.getAttribute("points").split(" ").length},SVGPolylineElement.prototype.SetWidthAndColor=function(t,e){this.setAttribute("stroke",e),this.setAttribute("fill",e),this.setAttribute("stroke-width",t)},SVGPolylineElement.prototype.GetID=function(){return parseInt(this.getAttribute("data-id"))},SVGPolylineElement.prototype.SetID=function(t){this.setAttribute("data-id",t)},SVGPolylineElement.prototype.GetFillColor=function(){return this.getAttribute("fill")},SVGPolylineElement.prototype.Serialize=function(){return{iId:this.GetID(),Color:this.GetFillColor(),PointsAsString:this.GetPointsString()}},this.CreateSVGVML=function(t,i,r,{iGridWidth:s,iGridHeight:a},h){return this.#e=n(t),i&&this.#e.setAttributeNS(null,"width",i),r&&this.#e.setAttributeNS(null,"height",r),t&&(void 0!==s&&void 0!==a&&this.#e.setAttribute("viewBox",`0 0 ${s} ${a}`),this.#t=this.#e.createSVGPoint()),e=h,o?this.#e:null},this.CreatePolyline=function(t,n,i=undefined){const o=r("polyline");return void 0!==e&&o.setAttribute("shape-rendering",!0===e?"auto":"optimizeSpeed"),void 0!==i&&o.setAttribute("stroke-width",i),n&&(o.setAttribute("stroke",n),o.setAttribute("fill",n)),t&&o.setAttribute("points",t),o.setAttribute("data-id",0),this.#e.appendChild(o),o},this.CreateOval=function(t=undefined){const n=r("circle");return void 0!==e&&n.setAttribute("shape-rendering",!0===e?"auto":"optimizeSpeed"),void 0!==t&&n.setAttribute("r",t),n.setAttribute("data-status",s(i.POINT_FREE)),this.#e.appendChild(n),n};const s=function(t){switch(t){case i.POINT_FREE_RED:return Object.keys(i)[0];case i.POINT_FREE_BLUE:return Object.keys(i)[1];case i.POINT_FREE:return Object.keys(i)[2];case i.POINT_STARTING:return Object.keys(i)[3];case i.POINT_IN_PATH:return Object.keys(i)[4];case i.POINT_OWNED_BY_RED:return Object.keys(i)[5];case i.POINT_OWNED_BY_BLUE:return Object.keys(i)[6];default:throw new Error("bad status enum value")}},a=function(t){switch(t.toUpperCase()){case Object.keys(i)[0]:return i.POINT_FREE_RED;case Object.keys(i)[1]:return i.POINT_FREE_BLUE;case Object.keys(i)[2]:return i.POINT_FREE;case Object.keys(i)[3]:return i.POINT_STARTING;case Object.keys(i)[4]:return i.POINT_IN_PATH;case Object.keys(i)[5]:return i.POINT_OWNED_BY_RED;case Object.keys(i)[6]:return i.POINT_OWNED_BY_BLUE;default:throw new Error("bad status enum string")}}}RemoveOval(t){this.#e.removeChild(t)}RemovePolyline(t){this.#e.removeChild(t)}DeserializeOval(t,e=undefined){let{x:n,y:i,Status:r,Color:o}=t;n=parseInt(n),i=parseInt(i);const s=this.CreateOval(e);return s.move(n,i),s.SetFillColor(o),s.SetStatus(r),s}DeserializePolyline(t,e=undefined){const{iId:n,Color:i,PointsAsString:r}=t,o=this.CreatePolyline(r,i,e);return o.SetID(n),o}ToCursorPoint(t,e){this.#t.x=t,this.#t.y=e;return this.#t.matrixTransform(this.#e.getScreenCTM().inverse())}IsPointInCircle(t,e,n,i=4){const r=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),o=Math.pow(n,2);return Math.abs(r-o)<i?1:r===o?0:-1}}class l{#n;#i;#r;#o;#s;constructor(t,e,n){this.#n=t,this.#i=e,this.#r=n,this.#o=i.POINT_STARTING,this.#s=i.POINT_IN_PATH}async BuildGraph({freePointStatus:t=i.POINT_FREE_BLUE,cpufillCol:e="var(--bluish)"}={}){const n=new Map,r=new Map,o=function(t,n){const i=n.GetStatus();return!(!t.includes(i)||n.GetFillColor()!==e)},s=async(e,i,s,a,h)=>{if(i>=0&&i<this.#n&&s>=0&&s<this.#i){const l=await this.#r.get(s*this.#n+i);if(l&&!0===o([t],l)){const t=`${a},${h}`,o=`${i},${s}`;if(!1===r.has(`${t}_${o}`)&&!1===r.has(`${o}_${t}`)){if(r.set(`${t}_${o}`,{from:e,to:l}),n.has(t)){n.get(t).adjacents.push(l)}else e.adjacents=[l],n.set(t,e);if(n.has(o)){n.get(o).adjacents.push(e)}else l.adjacents=[e],n.set(o,l)}}}};for(const e of await this.#r.values())if(e&&!0===o([t,this.#o,this.#s],e)){const{x:t,y:n}=e.GetPosition();await s(e,t+1,n,t,n),await s(e,t-1,n,t,n),await s(e,t,n-1,t,n),await s(e,t,n+1,t,n),await s(e,t-1,n-1,t,n),await s(e,t+1,n-1,t,n),await s(e,t-1,n+1,t,n),await s(e,t+1,n+1,t,n)}return{vertices:Array.from(n.values()),edges:Array.from(r.values())}}async#a(t,e,n){for(const i of n){if(!1!==s(i.GetPointsArray(),t,e))return!1}return!0}async MarkAllCycles(t,e,n,r){const o=t.vertices,s=o.length;let h=new Array(s);const l=new Array(s),u=new Array(s),c=new Array(s);for(let t=0;t<s;t++)l[t]=[],h[t]=[];const p=async function(t,e){if(2===u[t])return;if(1===u[t]){f++;let n=e;for(l[n].push(f);n!==t;)n=c[n],l[n].push(f);return}c[t]=e,u[t]=1;const n=o[t];if(n)for(const e of n.adjacents){const n=o.indexOf(e);n!==c[t]&&await p(n,t)}u[t]=2};let f=0,d=s;for(let t=0;t<s;t++)await p(t+1,t);return await(async(t,e)=>{for(let n=0;n<t;n++){const t=e[n];if(void 0!==t&&t.length>0)for(let e=0;e<t.length;e++){const i=h[t[e]];void 0!==i&&i.push(n)}}h=h.filter((t=>t.length>=4)).sort(((t,e)=>e.length-t.length));const s=[];for(const t of await this.#r.values())if(void 0!==t&&t.GetFillColor()===n&&i.POINT_FREE_RED===t.GetStatus()){const{x:e,y:n}=t.GetPosition();if(!1===await this.#a(e,n,r))continue;s.push({x:e,y:n})}for(let t=0;t<=f;t++){const e=h[t];if(e&&e.length>0){const n=a(e.map((t=>o[t].GetPosition())));h[t]={cycl:e,cw_sorted_verts:n}}}return{cycles:h,free_human_player_points:s,cyclenumber:f}})(d,l)}}var u=n(169);addEventListener("message",(async function(t){const n=t.data;switch(n.operation){case"BUILD_GRAPH":{const t=new h;t.CreateSVGVML(null,null,null,n.boardSize);const e=n.paths.map((e=>t.DeserializePolyline(e))),o=new Map;n.points.forEach((e=>{o.set(e.key,t.DeserializeOval(e.value))})),r(`lines.count = ${await e.length}, points.count = ${await o.size}`);const s=new l(n.state.iGridWidth,n.state.iGridHeight,o),a=await s.BuildGraph({freePointStatus:i.POINT_FREE_BLUE,cpufillCol:"var(--bluish)",visuals:!1});postMessage({operation:n.operation,params:a})}break;case"CONCAVEMAN":{const t=new h;t.CreateSVGVML(null,null,null,n.boardSize);const r=new Map;n.points.forEach((e=>{r.set(e.key,t.DeserializeOval(e.value))}));const o=new l(n.state.iGridWidth,n.state.iGridHeight,r),s=(await o.BuildGraph({freePointStatus:i.POINT_FREE_BLUE,cpufillCol:"var(--bluish)",visuals:!1})).vertices.map((function(t){const{x:e,y:n}=t.GetPosition();return[e,n]})),u=e()(s,2,0),c=a(u.map((([t,e])=>({x:t,y:e}))));postMessage({operation:n.operation,convex_hull:u,cw_sorted_verts:c})}break;case"MARK_ALL_CYCLES":{const t=new h;t.CreateSVGVML(null,null,null,n.boardSize);const e=n.paths.map((e=>t.DeserializePolyline(e))),r=new Map;n.points.forEach((e=>{r.set(e.key,t.DeserializeOval(e.value))}));const o=new l(n.state.iGridWidth,n.state.iGridHeight,r),s=await o.BuildGraph({freePointStatus:i.POINT_FREE_BLUE,cpufillCol:n.colorBlue,visuals:!1}),a=await o.MarkAllCycles(s,n.colorBlue,n.colorRed,e);postMessage({operation:n.operation,cycles:a.cycles,free_human_player_points:a.free_human_player_points,cyclenumber:a.cyclenumber})}break;case"ASTAR":{const{arr:t,start:e,end:i}=n,o=new u.Graph(t,{diagonal:!0}),s=o.grid[e.y][e.x],a=o.grid[i.y][i.x],h=u.astar.search(o,s,a,{heuristic:u.astar.heuristics.diagonal});r(h),postMessage({operation:n.operation,resultWithDiagonals:h})}break;default:o(`unknown params.operation = ${n.operation}`)}})),r("Worker loaded")}()}();
//# sourceMappingURL=AIWorker.Bundle.js.map