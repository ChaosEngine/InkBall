"use strict";const StatusEnum=Object.freeze({POINT_FREE:-1,POINT_STARTING:0,POINT_IN_PATH:1,POINT_OWNED_BY_RED:2,POINT_OWNED_BY_BLU:3}),CommandKindEnum=Object.freeze({UNKNOWN:-1,PING:0,POINT:1,PATH:2,PLAYER_JOINING:3,PLAYER_SURRENDE:4});class InkBallPointViewModel{constructor(a=0,b=0,c=0,d=0,e=0,f=StatusEnum.POINT_FREE,g=0){this.iId=a,this.iGameId=b,this.iPlayerId=c,this.iX=d,this.iY=e,this.Status=f,this.iEnclosingPathId=g}static Format(a,b){let c=b.iX+" "+b.iY+" "+b.Status;return a+" places "+c+" point"}}class PingCommand{get Message(){return this.message}set Message(a){this.message=a}constructor(a=""){this.Message=a}static Format(a,b){let c=b.Message;return a+" says "+c}}function htmlEncode(a){return document.createElement("a").appendChild(document.createTextNode(a)).parentNode.innerHTML}var g_SignalRConnection=null,g_iGameID=null,g_iPlayerID=null;function BuildSignalR(a,b,c,d,e){null===a||""===a||(g_SignalRConnection=new signalR.HubConnectionBuilder().withUrl(a,{transport:d,accessTokenFactory:e}).withHubProtocol(c).configureLogging(b).build())}function StartSignalRConnection(a,b){async function c(){try{await g_SignalRConnection.start(),d=0,console.log("connected; iConnErrCount = "+d)}catch(a){console.log(a+"; iConnErrCount = "+d),5>d&&d++,setTimeout(()=>c(),4e3+2e3*d)}}let d=0;null===g_SignalRConnection||(g_iGameID=a,g_iPlayerID=b,g_SignalRConnection.on("ServerToClientPoint",function(a,b){let c=null;c=InkBallPointViewModel.Format(b,a);let d=document.createElement("li");d.textContent=c,document.getElementById("messagesList").appendChild(d)}),g_SignalRConnection.on("ServerToClientPing",function(a,b){let c=null;c=PingCommand.Format(b,a);let d=document.createElement("li");d.textContent=c,document.getElementById("messagesList").appendChild(d)}),document.getElementById("sendButton").addEventListener("click",function(a){let b=document.getElementById("messageInput").value,c=new PingCommand(b);g_SignalRConnection.invoke("ClientToServerPing",c).catch(function(a){return console.error(a.toString())}),a.preventDefault()}),document.getElementById("messageInput").addEventListener("keyup",function(a){a.preventDefault(),13===a.keyCode&&document.getElementById("sendButton").click()}),g_SignalRConnection.onclose(async a=>{null===a?await c():(console.log(a),5>d&&d++,setTimeout(()=>c(),4e3+2e3*d))}),c())}